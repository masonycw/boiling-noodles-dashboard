# 自動收信與報表轉檔計畫

未來的目標是將每天收到含有會員交易紀錄的信件，自動從 XLS 轉成 CSV，並上傳到伺服器供智慧報表使用。

## 方案規劃：部署在伺服器上全自動化 (推薦)
建議將此腳本部署在 34.81.51.45 伺服器上，設定每天結帳後（例如凌晨 02:00）自動透過 Linux Cron 排程執行。
這樣可以直接將轉好的檔案存在伺服器的 `data` 資料夾，省去 SFTP 傳輸的步驟，且不用擔心個人電腦未開機。

## 自動化技術實作四大步驟

### 1. 取得信箱授權 (IMAP)
*   **Gmail 會員**：基於安全性，需開啟「兩步驟驗證」，並到 Google 帳號設定中申請一組專用的「應用程式密碼 (App Password)」，讓 Python 可以安全登入信箱。

### 2. 自動搜尋信件並下載
*   使用 Python 內建的 `imaplib` 及 `email` 套件。
*   程式連線登入信箱後，自動搜尋特定寄件人（例如 POS 系統發信端）或特定主旨（例如「每日交易報表」）。
*   找到當天的郵件後，將附件 (`.xls`) 下載到伺服器的暫存區。

### 3. 資料轉檔 (XLS 轉 CSV)
*   與本地轉檔工具邏輯相同，使用 `pandas` 套件讀取下載的 XLS 檔案。
*   將其匯出成 CSV 檔案，並使用 `utf-8-sig` 編碼（防止 Excel 開啟或系統讀取時發生中文亂碼）。

### 4. 檔案歸檔與排程設定
*   將轉換完成的 CSV 檔案移至 `BoilingNoodles_Dashboard/data/` 目錄中，並清理暫存的 XLS 檔案。
*   在伺服器上使用 `crontab -e` 設定每日定時任務 (Cron Job)。
*   例如設定 `0 2 * * * /path/to/venv/bin/python /path/to/auto_email_fetcher.py` 讓它每天凌晨 2 點自動執行。

---
*備註：當確定要執行此計畫時，可以隨時開始撰寫 `auto_email_fetcher.py` 程式碼。*
